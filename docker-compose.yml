
version: '3.8'

services:
  # âš¡ Backend API
  api:
    build: ./api
    ports:
      - "8000:8000"
    volumes:
      - ./api:/app  # Hot reload in dev
      - ./antigravity:/app/antigravity # Shared skills
      - ./gemini.md:/app/gemini.md # Project context
    environment:
      - PYTHONUNBUFFERED=1
    restart: unless-stopped

  # ðŸŽ¨ Frontend Dashboard
  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    environment:
      - PORT=3000
      # In docker network, API is at http://api:8000
      # But client browser access needs localhost mapping or proxy
      # For simple SSR/Client hybrid, we often need PUBLIC_API_URL
      - PUBLIC_API_URL=http://localhost:8000/api 
    depends_on:
      - api
    restart: unless-stopped

volumes:
  chroma_data: # Persist vector memory
